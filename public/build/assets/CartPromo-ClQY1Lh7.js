import{m as a,h as D,p as W,N as F,f as S,o as f,b as l,a as J,w as k,u as C,j as N,e as E,c as L,g as A,t as i}from"./app-Bt6ztAfV.js";import{u as R}from"./SettingStore-Dmkk0slu.js";const G={class:"border border-gray-300 border-opacity-1 border-0.5 p-2 bg-white w-full rounded-lg"},P={class:"flex items-center"},$=["src"],z={class:"text-xs text-gray-900 text-left font-medium"},T={class:"text-sm text-gray-700 flex flex-col"},U={class:"flex flex-row items-center w-full"},_={class:"w-full text-lg font-bold text-rojo text-center"},M={class:"w-full text-lg font-bold"},Q={key:0,class:"flex flex-row items-center"},H={class:"text-orange-500 text-lg"},Y={__name:"CartPromo",props:{producto:Object,image:Object},setup(s){const t=s,I=R(),O=a(!1),g=a(0),r=a(1),V=a(1),c=a(0),u=a(0),n=a(0),v=a(""),x=a(""),h=a(0),w=a([]),j=a(!1),d=a("");c.value=t.producto.id,w.value=t.producto.filter_items,h.value=t.producto.valoration,x.value=t.producto.specification,v.value=t.producto.name,n.value=t.producto.stock,u.value=t.producto.price;const m=D(()=>(g.value=(t.producto.price*parseFloat(I.getDolarValue)).toFixed(2),g.value)),q=a(window.innerWidth),p=()=>{q.value=window.innerWidth};W(()=>{V.value=t.producto.stock;const o=JSON.parse(localStorage.getItem("producto"))||[];j.value=o.some(e=>e.id===t.producto.id),window.addEventListener("resize",p),p(),d.value=t.image&&t.image.length>0?`/storage/${t.image[0].file_path}/${t.image[0].file}`:""}),F(()=>{window.removeEventListener("resize",p)});const b=()=>{O.value=!1},B=()=>{if(n.value===0){alert("Este producto no tiene stock disponible.");return}const o=JSON.parse(localStorage.getItem("producto"))||[],e=o.findIndex(y=>y.id===c.value);if(e!==-1){if(o[e].quantity+r.value>n.value){alert("No puedes agregar más de lo disponible en stock.");return}o[e].quantity+=r.value,o[e].subtotal=o[e].price*o[e].quantity,localStorage.setItem("producto",JSON.stringify(o)),b();return}else o.push({id:c.value,name:v.value,pricedolar:u.value,pricesoles:m.value,quantity:r.value,subtotaldolar:u.value*r.value,subtotalsoles:m.value*r.value,specification:x.value,valoration:h.value,filter_items:w.value,stock:n.value,routeimage:d.value}),localStorage.setItem("producto",JSON.stringify(o)),b(),window.location.reload()};return(o,e)=>(f(),S("div",G,[l("div",P,[J(C(N),{href:o.route("productid",{slug:s.producto.slug}),class:"p-1"},{default:k(()=>[l("img",{src:d.value,alt:"Imagen",class:"w-32 h-full rounded"},null,8,$)]),_:1},8,["href"]),l("p",z,[E(i(s.producto.name.length>80?(s.producto.name.slice(0,77)+" ...").charAt(0)+(s.producto.name.slice(0,77)+" ...").slice(1):s.producto.name.charAt(0)+s.producto.name.slice(1))+" ",1),s.producto.name.length>80?(f(),L(C(N),{key:0,href:o.route("productid",{slug:s.producto.slug}),class:"text-blue font-medium"},{default:k(()=>e[0]||(e[0]=[E("Ver más ")])),_:1},8,["href"])):A("",!0)])]),l("div",T,[l("div",U,[l("span",_,"$ "+i(s.producto.price),1),l("span",M,"S/. "+i(m.value.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),1),s.producto.discount>0?(f(),S("p",Q,[e[1]||(e[1]=l("span",null,"Descuento:",-1)),l("span",H,i(s.producto.discount)+"%",1)])):A("",!0)]),l("form",{class:"w-full flex p-1"},[l("button",{onClick:B,class:"w-full rounded-lg bg-cremaclaro p-2 font-bold transition hover:text-white flex items-center justify-center"},e[2]||(e[2]=[l("span",{class:""},"AGREGAR AL CARRITO",-1)]))])])]))}};export{Y as default};
