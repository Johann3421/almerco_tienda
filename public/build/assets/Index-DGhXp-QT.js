import{_ as O}from"./AuthenticatedLayout-ByaiLawU.js";import{_ as R}from"./SimpleHeader-3wKLLGQt.js";import{_ as W}from"./Notification-lgF43WH4.js";import{m as d,p as X,r,f as Y,a,w as t,u as f,F as ee,o as P,b as u,Z as te,d as n,t as p,j as S,c as F}from"./app-Tg2vsIGN.js";import{F as oe}from"./favicon-y_XG_-ev.js";import{d as ae}from"./index-zPKH93FC.js";import"./CompanyLogo-CxfACTdu.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const le=["href"],se={class:"py-6 h-full"},re={class:"max-w-8xl mx-auto sm:px-4 lg:px-6"},ne={class:"overflow-hidden sm:rounded-sm lg:rounded-lg grid place-items-center"},ie={class:"bg-gris-300 w-full grid place-items-center"},ce={class:"max-w-screen-2xl w-full px-4 py-4 sm:px-6 sm:py-4 lg:px-12 lg:py-12 bg-white-200 rounded-lg"},de={class:"grid place-items-center w-12/12 mt-4"},ue={class:"text-gray-900 font-medium"},ke={__name:"Index",setup(me){const m=d([]),_=d(!1),V=d(0),g=d(""),C=d(""),z=d(10),D=d(!1),j=async({page:l,itemsPerPage:e,sortBy:c})=>{_.value=!0;try{const s=await axios.get(route("products.load",{page:l,itemsPerPage:e,sortBy:c,sortDesc:"asc",search:g.value}));m.value=s.data.products.data,V.value=s.data.products.total}catch(s){console.error(s)}finally{_.value=!1}},I=ae(()=>{C.value=g.value},250),E=d([]);X(async()=>{E.value=[{title:"ID",key:"id",align:"center",sortable:!1},{title:"Producto",key:"name",align:"start",sortable:!0},{title:"Precio Anterior",key:"previous_price",align:"center",sortable:!1},{title:"Precio",key:"price",align:"center",sortable:!1},{title:"En Tienda",key:"on_sale",align:"center",sortable:!1},{title:"Stock",key:"stock",align:"center",sortable:!1},{title:"Acciones",key:"actions",align:"center",sortable:!1}]});const v=d({id:0,name:"",previous_price:0,price:0,on_sale:!1,stock:0}),y=d(!1),N=async()=>{try{D.value=!0;const l=await axios.delete(route("products.destroy",v.value.id));l.status===200&&(m.value=m.value.filter(e=>e.id!==v.value.id),b(!0,l.data.message,"#D4E7C5",1e3))}catch(l){A(l,"Ha ocurrido un error al eliminar el producto")}finally{D.value=!1,$()}},$=()=>{y.value=!1,v.value={id:0,name:"",previous_price:0,price:0,on_sale:!1,stock:0}},q=async(l,e)=>{_.value=!0;try{const c=await axios.patch(route("products.updateVisibility"),{id:l,visibility:e});!c.request.status===200?m.value=m.value.map(s=>(s.id===l&&(s.on_sale=!e),s)):b(!0,c.data.message,"#D4E7C5",1e3)}catch(c){console.error(c),m.value=m.value.map(s=>(s.id===l&&(s.on_sale=!e),s)),A(c,"Ha ocurrido un error al actualizar la visibilidad del producto")}finally{_.value=!1}},H=(l,e)=>{v.value=e,y.value=!0},i=d({status:!1,message:"",color:"#D4E7C5",timeout:1e3,vertical:!0,location:"right top",rounded:"md"}),b=(l,e,c,s)=>{i.value.status=l,i.value.message=e,i.value.color=c,i.value.timeout=s},A=(l,e)=>{console.error(l),b(!0,e,"#F9D7DA",3e3)};return(l,e)=>{const c=r("v-card-subtitle"),s=r("v-card-title"),h=r("v-btn"),L=r("v-spacer"),M=r("v-card-actions"),U=r("v-card"),T=r("v-dialog"),B=r("v-col"),k=r("v-icon"),G=r("v-row"),Q=r("v-text-field"),Z=r("v-progress-linear"),x=r("v-chip"),J=r("v-switch"),K=r("v-data-table-server");return P(),Y(ee,null,[a(f(te),{title:"Productos"},{default:t(()=>[u("link",{rel:"icon",href:f(oe),type:"image/png",sizes:"16x16"},null,8,le),e[5]||(e[5]=u("meta",{name:"viewport",content:"width=device-width, initial-scale=1"},null,-1))]),_:1}),a(W,{modelValue:i.value.status,"onUpdate:modelValue":e[0]||(e[0]=o=>i.value.status=o),message:i.value.message,color:i.value.color,timeout:i.value.timeout,vertical:i.value.vertical,location:i.value.location,rounded:i.value.rounded,style:{margin:"6.5rem 2rem 0 0"}},{default:t(()=>[n(p(i.value.message),1)]),_:1},8,["modelValue","message","color","timeout","vertical","location","rounded"]),a(T,{modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=o=>y.value=o),"max-width":"700",persistent:""},{default:t(()=>[a(U,{class:"bg-white rounded-lg flex flex-col md:ml-auto w-full mt-10 md:mt-0 relative z-10 shadow-md py-6"},{default:t(()=>[a(s,{class:"text-gray-900 text-lg mb-1 font-medium title-font text-center"},{default:t(()=>[n(" ¿ Estás seguro de que quieres borrar el producto "+p(v.value.name)+" ? ",1),a(c,{class:"leading-relaxed text-gray-600 my-2"},{default:t(()=>e[6]||(e[6]=[n(" Esta acción no se puede deshacer ")])),_:1})]),_:1}),a(M,{class:"mx-52"},{default:t(()=>[a(h,{color:"red",variant:"tonal",onClick:e[1]||(e[1]=o=>N(v.value)),loading:l.fetch_loader_form},{default:t(()=>e[7]||(e[7]=[n(" Eliminar ")])),_:1},8,["loading"]),a(L),a(h,{color:"primary",variant:"tonal",onClick:$},{default:t(()=>e[8]||(e[8]=[n(" Cancelar ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(O,null,{default:t(()=>[u("div",se,[u("div",re,[u("div",ne,[u("section",ie,[u("div",ce,[a(R,{title:"Gestiona tus Productos",breadcrumb:"Productos",breadcrumb_link:l.route("products.index")},null,8,["breadcrumb_link"]),u("article",de,[a(U,{flat:"",class:"w-full"},{title:t(()=>[a(G,{align:"center",justify:"space-between",density:"comfortable",class:"p-2"},{default:t(()=>[a(B,{cols:"12",md:"6"},{default:t(()=>e[9]||(e[9]=[u("h2",{class:"text-lg md:text-xl lg:text-xl text-gray-900"}," Productos ",-1)])),_:1}),a(B,{cols:"12",md:"6",class:"text-right flex justify-end items-center"},{default:t(()=>[a(f(S),{href:l.route("products.create"),type:"button"},{default:t(()=>[a(h,{color:"primary"},{default:t(()=>[a(k,{left:""},{default:t(()=>e[10]||(e[10]=[n("mdi-plus")])),_:1}),e[11]||(e[11]=n(" Agregar Producto "))]),_:1})]),_:1},8,["href"])]),_:1})]),_:1})]),text:t(()=>[a(Q,{modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=o=>g.value=o),label:"Buscar Producto","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"","single-line":"",density:"comfortable",color:"primary",onInput:f(I)},null,8,["modelValue","onInput"]),a(K,{"items-per-page":z.value,"onUpdate:itemsPerPage":e[4]||(e[4]=o=>z.value=o),headers:E.value,items:m.value,"items-length":V.value,loading:_.value,search:C.value,"item-value":"name","onUpdate:options":j,"loading-text":"Cargando Productos","no-data-text":"Actualmente no hay productos disponibles","items-per-page-text":"Productos por página"},{loader:t(({isActive:o})=>[a(Z,{active:o,color:"primary",height:"3",indeterminate:""},null,8,["active"])]),"item.index":t(({index:o})=>[n(p(o+1),1)]),"item.previous_price":t(({item:o})=>[a(x,{color:"gray",class:"text-uppercase",label:"",size:"small"},{default:t(()=>[n(" $ "+p(o.previous_price),1)]),_:2},1024)]),"item.price":t(({item:o})=>[a(x,{color:"primary",class:"text-uppercase",label:"",size:"small"},{default:t(()=>[n(" $ "+p(o.price),1)]),_:2},1024)]),"item.on_sale":t(({item:o})=>[a(J,{modelValue:o.on_sale,"onUpdate:modelValue":w=>o.on_sale=w,color:"#0e7490",style:{"justify-content":"center"},onChange:w=>q(o.id,o.on_sale)},{label:t(()=>[u("span",ue,p(o.on_sale?"Sí":"No"),1)]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),"item.stock":t(({item:o})=>[o.stock?(P(),F(x,{key:0,color:"green",label:"",size:"small"},{default:t(()=>[n(p(o.stock),1)]),_:2},1024)):(P(),F(x,{key:1,color:"red",label:"",size:"small"},{default:t(()=>e[12]||(e[12]=[n(" Agotado ")])),_:1}))]),"item.actions":t(({item:o})=>[a(f(S),{href:l.route("products.edit",o.id),class:"inline-block me-2 transition hover:scale-125"},{default:t(()=>[a(k,{size:"small",class:"me-2",color:"primary"},{default:t(()=>e[13]||(e[13]=[n(" mdi-pencil ")])),_:1})]),_:2},1032,["href"]),a(k,{size:"small",onClick:w=>H("delete_product",o),color:"#f44336",class:"cursor-pointer transition hover:scale-125"},{default:t(()=>e[14]||(e[14]=[n(" mdi-delete ")])),_:2},1032,["onClick"])]),_:1},8,["items-per-page","headers","items","items-length","loading","search"])]),_:1})])])])])])])]),_:1})],64)}}};export{ke as default};
