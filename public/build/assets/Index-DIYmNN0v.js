import{l as ee,m as h,f as w,o as c,a as t,b as r,w as a,e as v,t as U,n as G,d as E,F as j,p as te,r as g,u as y,Z as ae,q as re,s as le,c as A,g as X}from"./app-Bt6ztAfV.js";import{_ as se}from"./AuthenticatedLayout-qY5f_ClU.js";import{_ as ne}from"./SimpleHeader-GwSpMYdP.js";import{_ as J}from"./Notification-CzGbMN4e.js";import{r as oe}from"./UseFormRules-BSUHPM2v.js";import{F as ie}from"./favicon-CdIV8-2k.js";import"./CompanyLogo-BSu69qOk.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const K=ee("BannerImageStore",{state:()=>({file:null,url:null,loading:!1,working:!1}),actions:{setUrl(l){this.url=l},setFile(l){this.file=l},setLoading(l){this.loading=l,l&&(this.setUrl(null),this.setFile(null))},setWorking(l){this.working=l},$reset(){this.url=null,this.file=null,this.loading=!1,this.working=!1},sleep(l){return new Promise(x=>setTimeout(x,l))}},getters:{getFile:l=>l.file,getUrl:l=>l.url,getLoading:l=>l.loading,getWorking:l=>l.working}}),Z={__name:"DragAndDrop",props:{text:{type:String,default:"Arrastra y suelta una imagen aquí"},color_text:{type:String,default:"text-gray-600"},color_body:{type:String,default:"bg-gray-500"},color_border:{type:String,default:"border-gray-500"}},setup(l){const x=K(),o=async _=>{x.setWorking(!0),x.setLoading(!0);const p=_.dataTransfer.files[0];if(!/(\.jpg|\.jpeg|\.png|\.gif)$/i.exec(p.name))return x.$reset(),n("Error: Formato de archivo no permitido","Solo se permiten archivos jpg, jpeg, png y gif");const F=new FileReader,S=()=>new Promise(z=>{F.onload=I=>{const L=I.target.result;x.setUrl(L),z()}});F.readAsDataURL(p),await S(),x.setFile(p),x.setLoading(!1)},b=_=>{console.log("Saliendo de la zona")},V=_=>{},s=h({status:!1,message:"",color:"#D4E7C5",timeout:1e3,vertical:!0,location:"right top",rounded:"md"}),B=(_,u,p,D)=>{s.value.status=_,s.value.message=u,s.value.color=p,s.value.timeout=D},n=(_,u)=>{console.error(_),B(!0,u,"#F9D7DA",3e3)};return(_,u)=>(c(),w(j,null,[t(J,{modelValue:s.value.status,"onUpdate:modelValue":u[0]||(u[0]=p=>s.value.status=p),message:s.value.message,color:s.value.color,timeout:s.value.timeout,vertical:s.value.vertical,location:s.value.location,rounded:s.value.rounded,style:{margin:"6.5rem 2rem 0 0"}},{default:a(()=>[v(U(s.value.message),1)]),_:1},8,["modelValue","message","color","timeout","vertical","location","rounded"]),r("div",{onDragover:E(V,["prevent"]),onDragleave:E(b,["prevent"]),onDrop:u[1]||(u[1]=E(p=>o(p),["prevent"])),class:G(["w-full aspect-39/10 bg-clip-padding bg-origin-content bg-no-repeat bg-center bg-cover border-2 border-dashed rounded-lg flex justify-center items-center opacity-1 hover:opacity-70 hover:cursor-pointer transition duration-100 ease-in-out",`${l.color_border} ${l.color_body}')]`])},[r("span",{class:G(["text-sm sm:text-lg md:text-xl lg:text-xl text-overline",`${l.color_text}`])},U(l.text),3)],34)],64))}},de=["href"],ue={class:"py-6 h-full"},me={class:"max-w-8xl mx-auto sm:px-4 lg:px-6"},ce={class:"overflow-hidden sm:rounded-sm lg:rounded-lg grid place-items-center"},pe={class:"bg-gris-300 w-full grid place-items-center mt-4"},fe={class:"max-w-screen-2xl w-full px-4 py-4 sm:px-6 sm:py-4 lg:px-12 lg:py-12 bg-white-200 rounded-lg"},ve={class:"grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6 p-2 md:p-4 mt-4"},ge={key:0,class:"grid grid-rows-auto md:grid-rows-auto gap-4 md:gap-6 pt-2"},ye=["onClick"],_e=["src"],xe={key:1,class:"flex justify-center items-center h-96 text-underlined"},be={class:"flex justify-center items-center h-96"},he={key:0,class:"mb-1 p-2"},we={key:1,class:"mb-1 p-2"},ke={class:"flex flex-col"},Be={class:"flex justify-content-center align-items-center sm:pb-2 md:pb-4 mt-4"},De={class:"d-flex align-center justify-center fill-height"},Ce={class:"flex flex-col"},$e={class:"flex justify-content-center align-items-center sm:pb-2 md:pb-4 mt-4"},je={class:"d-flex align-center justify-center fill-height"},Ee={class:"flex gap-4"},Te={__name:"Index",props:{banners:{type:Array,required:!0}},setup(l){const x=l,o=K(),b=h([]),V=h(!1),s=h(!1);te(async()=>{b.value=x.banners});const B=h(!1),n=h({id:null,name:"",file_path:"",file:"",image:"",active:!0,token:""}),_=oe,u=h(!1),p=h(null),D=h(null),F=(d,e)=>{u.value=!0,n.value=e},S=d=>{o.$reset(),B.value=!0,n.value=d},z=async()=>{const{valid:d}=await p.value.validate();if(!o.getFile){C(!0,"Error: Archivo no seleccionado","#F9D7DA",3e3);return}if(d){s.value=!0;try{const e=new FormData;e.append("name",n.value.name),e.append("image",o.getFile),e.append("active",n.value.active);const m=await axios.post(route("banners.store"),e,{headers:{"Content-Type":"multipart/form-data"}});m.status===201&&(b.value.push(m.data.banner),C(!0,m.data.message,"#D4E7C5",2e3))}catch(e){N(e,"Error al agregar el Banner")}finally{s.value=!1,o.$reset(),p.value.reset()}}},I=async()=>{const{valid:d}=await D.value.validate();if(d){s.value=!0;try{const e=new FormData;e.append("name",n.value.name),e.append("image",o.getFile),e.append("active",n.value.active);const m=await axios.post(route("banners.update",n.value.id),e,{headers:{"Content-Type":"multipart/form-data","X-HTTP-Method-Override":"PATCH"}});if(m.status===200){const $=b.value.findIndex(k=>k.id===m.data.banner.id);b.value[$]=m.data.banner,C(!0,m.data.message,"#D4E7C5",2e3)}}catch(e){N(e,"Error al actualizar el Banner")}finally{s.value=!1,B.value=!1,o.$reset(),D.value.reset()}}},L=async()=>{try{s.value=!0;const d=await axios.delete(route("banners.destroy",n.value.id));d.status===200&&(b.value=b.value.filter(e=>e.id!==n.value.id),C(!0,d.data.message,"#D4E7C5",2e3),o.$reset(),Updating.value=!1)}catch(d){N(d,"Error al eliminar el Banner")}finally{s.value=!1,u.value=!1}},Q=()=>{o.$reset(),B.value=!1,n.value={id:null,name:"",file_path:"",file:"",image:"",active:!0,token:""}},f=h({status:!1,message:"",color:"#D4E7C5",timeout:1e3,vertical:!0,location:"right top",rounded:"md"}),C=(d,e,m,$)=>{f.value.status=d,f.value.message=e,f.value.color=m,f.value.timeout=$},N=(d,e)=>{console.error(d),C(!0,e,"#F9D7DA",3e3)};return(d,e)=>{const m=g("v-card-text"),$=g("v-divider"),k=g("v-btn"),T=g("v-card-actions"),P=g("v-card"),Y=g("v-dialog"),W=g("v-progress-linear"),q=g("v-progress-circular"),M=g("v-icon"),H=g("v-text-field"),O=g("v-img"),R=g("v-form");return c(),w(j,null,[t(y(ae),{title:"Banners"},{default:a(()=>[r("link",{rel:"icon",href:y(ie),type:"image/png",sizes:"16x16"},null,8,de),e[6]||(e[6]=r("meta",{name:"viewport",content:"width=device-width, initial-scale=1"},null,-1))]),_:1}),t(J,{modelValue:f.value.status,"onUpdate:modelValue":e[0]||(e[0]=i=>f.value.status=i),message:f.value.message,color:f.value.color,timeout:f.value.timeout,vertical:f.value.vertical,location:f.value.location,rounded:f.value.rounded,style:{margin:"6.5rem 2rem 0 0"}},{default:a(()=>[v(U(f.value.message),1)]),_:1},8,["modelValue","message","color","timeout","vertical","location","rounded"]),t(Y,{modelValue:u.value,"onUpdate:modelValue":e[2]||(e[2]=i=>u.value=i),"max-width":"450",persistent:""},{default:a(()=>[t(P,{"max-width":"450",title:"Eliminar Banner","prepend-icon":"mdi-delete"},{default:a(()=>[t(m,null,{default:a(()=>[e[7]||(e[7]=v(" ¿Estás seguro de eliminar el Banner ")),r("strong",null,U(n.value.name),1),e[8]||(e[8]=v("? "))]),_:1}),t(T,{class:"justify-between",style:{padding:"1rem 3rem"}},{default:a(()=>[t($),t(k,{onClick:e[1]||(e[1]=i=>u.value=!1)},{default:a(()=>e[9]||(e[9]=[v(" Cancelar ")])),_:1}),t(k,{color:"error",onClick:L,loading:s.value},{default:a(()=>e[10]||(e[10]=[v(" Eliminar ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(se,null,{default:a(()=>[r("div",ue,[r("div",me,[r("div",ce,[r("section",pe,[r("div",fe,[t(ne,{title:"Gestiona tus Banners",breadcrumb:"Banners",breadcrumb_link:d.route("banners.index")},null,8,["breadcrumb_link"]),r("article",ve,[t(P,{class:"md:col-span-1 p-2 md:p-6 sm:order-last md:order-first max-h-fit",loading:V.value},re({loader:a(({isActive:i})=>[t(W,{active:i,color:"primary",height:"3",indeterminate:""},null,8,["active"])]),title:a(()=>[e[11]||(e[11]=r("h2",{class:"mb-1 text-center p-2"}," Banners ",-1))]),_:2},[V.value?{name:"text",fn:a(()=>[r("div",be,[t(q,{color:"primary",indeterminate:"",size:35,width:4})])]),key:"1"}:{name:"text",fn:a(()=>[b.value.length>0?(c(),w("div",ge,[(c(!0),w(j,null,le(b.value,i=>(c(),w("div",{key:i.id,class:"rounded-lg cursor-pointer hover:opacity-80",onClick:Ve=>S(i)},[r("img",{src:`/storage/${i.file_path}/${i.file}`,alt:"Banner",class:"w-full rounded-lg aspect-39/10 object-cover"},null,8,_e)],8,ye))),128))])):(c(),w("div",xe," No hay banners disponibles "))]),key:"0"}]),1032,["loading"]),t(P,{class:"md:col-span-2 border-2 p-2 md:p-6 sm:order-first md:order-last",loading:y(o).getLoading},{loader:a(({isActive:i})=>[t(W,{active:i,color:"primary",height:"4",indeterminate:""},null,8,["active"])]),prepend:a(()=>[B.value?(c(),A(M,{key:1,class:"mx-2"},{default:a(()=>e[13]||(e[13]=[v("mdi-image-edit")])),_:1})):(c(),A(M,{key:0,class:"mx-2"},{default:a(()=>e[12]||(e[12]=[v("mdi-image-plus")])),_:1}))]),title:a(()=>[B.value?(c(),w("h2",we," Detalles del Banner ")):(c(),w("h2",he," Agregar Banner "))]),default:a(()=>[B.value?(c(),A(R,{key:1,ref_key:"form_update_banner",ref:D,onSubmit:E(I,["prevent"])},{default:a(()=>[t(m,{class:"px-6"},{default:a(()=>[r("div",Ce,[t(Z,{color_border:"border-orange-400"}),e[18]||(e[18]=r("span",{class:"flex items-center my-6"},[r("span",{class:"h-px flex-1 bg-primary"}),r("span",{class:"shrink-0 px-6 text-primary"},"Detalles"),r("span",{class:"h-px flex-1 bg-primary"})],-1)),t(H,{label:"Nombre",placeholder:"Nombre del Banner",variant:"outlined",modelValue:n.value.name,"onUpdate:modelValue":e[4]||(e[4]=i=>n.value.name=i),density:"comfortable",hint:"Ejemplo: Banner 1",class:"text-[#212121]",color:"primary",rules:[y(_).required]},null,8,["modelValue","rules"]),e[19]||(e[19]=r("div",{class:"flex flex-col md:mt-4"},[r("h3",{class:"text-[1rem] font-semibold text-gray-700"}," Previsualización:")],-1)),r("div",$e,[t(O,{alt:"Imagen cargada",class:"w-full rounded-lg aspect-39/10",cover:"","lazy-src":"https://picsum.photos/500/300",src:y(o).getUrl?y(o).getUrl:`/storage/${n.value.file_path}/${n.value.file}`},{placeholder:a(()=>[r("div",je,[t(q,{color:"grey-lighten-4",indeterminate:""})])]),_:1},8,["src"])])])]),_:1}),t(T,{class:"justify-between",style:{padding:"2rem"}},{default:a(()=>[t(k,{type:"button",class:"justify-center py-2 uppercase px-8 shadow-md text-sm font-semibold rounded-sm focus:outline-none transform transition-transform hover:scale-105",onClick:Q,variant:"tonal",color:"grey"},{default:a(()=>e[20]||(e[20]=[v(" Cancelar ")])),_:1}),r("div",Ee,[t(k,{type:"submit",class:"justify-center py-2 uppercase px-8 shadow-md text-sm font-semibold rounded-sm focus:outline-none transform transition-transform hover:scale-105",variant:"tonal",color:"primary",loading:s.value},{default:a(()=>e[21]||(e[21]=[v(" Actualizar ")])),_:1},8,["loading"]),t(k,{type:"button",class:"justify-center py-2 uppercase px-8 shadow-md text-sm font-semibold rounded-sm focus:outline-none transform transition-transform hover:scale-105",onClick:e[5]||(e[5]=i=>F("delete_banner",n.value)),variant:"tonal",color:"red"},{default:a(()=>e[22]||(e[22]=[v(" Eliminar ")])),_:1})])]),_:1})]),_:1},512)):(c(),A(R,{key:0,ref_key:"form_create_banner",ref:p,onSubmit:E(z,["prevent"])},{default:a(()=>[t(m,{class:"px-6"},{default:a(()=>[r("div",ke,[t(Z,{color_border:"border-orange-400"}),y(o).getWorking?(c(),w(j,{key:0},[e[14]||(e[14]=r("span",{class:"flex items-center my-6"},[r("span",{class:"h-px flex-1 bg-primary"}),r("span",{class:"shrink-0 px-6 text-primary"},"Detalles"),r("span",{class:"h-px flex-1 bg-primary"})],-1)),t(H,{label:"Nombre",placeholder:"Nombre del Banner",variant:"outlined",density:"comfortable",hint:"Ejemplo: Banner 1",class:"text-[#212121]",color:"primary",modelValue:n.value.name,"onUpdate:modelValue":e[3]||(e[3]=i=>n.value.name=i),rules:[y(_).required]},null,8,["modelValue","rules"]),e[15]||(e[15]=r("div",{class:"flex flex-col md:mt-4 pl-2"},[r("h3",{class:"text-[1.1rem] text-overline"}," Previsualización: ")],-1)),r("div",Be,[t(O,{alt:"Imagen cargada",class:"w-full rounded-lg aspect-39/10",cover:"","lazy-src":"https://picsum.photos/500/300",src:y(o).getLoading?"":y(o).getUrl},{placeholder:a(()=>[r("div",De,[t(q,{color:"grey-lighten-4",indeterminate:""})])]),_:1},8,["src"])])],64)):X("",!0)])]),_:1}),t(T,{class:"justify-between mx-36",style:{padding:"2rem"}},{default:a(()=>[y(o).getWorking?(c(),w(j,{key:0},[t(k,{type:"button",class:"justify-center py-2 uppercase px-8 shadow-md text-sm font-semibold rounded-sm focus:outline-none transform transition-transform hover:scale-105",onClick:y(o).$reset,variant:"tonal",color:"grey"},{default:a(()=>e[16]||(e[16]=[v(" Cancelar ")])),_:1},8,["onClick"]),t(k,{type:"submit",loading:s.value,class:"justify-center py-2 uppercase px-8 shadow-md text-sm font-semibold rounded-sm focus:outline-none transform transition-transform hover:scale-105",variant:"tonal",color:"primary"},{default:a(()=>e[17]||(e[17]=[v(" Agregar ")])),_:1},8,["loading"])],64)):X("",!0)]),_:1})]),_:1},512))]),_:1},8,["loading"])])])])])])])]),_:1})],64)}}};export{Te as default};
