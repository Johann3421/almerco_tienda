import{m as _,z as fe,r as i,f as Q,o as I,a as l,w as o,e as n,t as k,x as U,h as qe,p as Ee,b as s,u as d,Z as he,d as se,F as ie,s as be,c as T}from"./app-Bt6ztAfV.js";import{_ as Ue}from"./AuthenticatedLayout-qY5f_ClU.js";import{F as De}from"./favicon-CdIV8-2k.js";import{_ as Ne}from"./Notification-CzGbMN4e.js";import{_ as Oe}from"./SimpleHeader-GwSpMYdP.js";import{r as Ie}from"./UseFormRules-BSUHPM2v.js";import{u as ye}from"./OrderStore-B13r27UW.js";import{d as je}from"./index-BtiajR1X.js";import{u as me,w as Fe}from"./xlsx-D8wqrsip.js";import{_ as Se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./CompanyLogo-BSu69qOk.js";const Ae={class:"flex justify-between items-center"},ge={__name:"OrderItemRow",props:{products:{type:Array,required:!0},product_id:{type:Number,required:!0},index:{type:Number,required:!0},amount:{type:Number,required:!0},unit_price:{type:Number,required:!0},unit_stock:{type:Number,required:!0},unit_name:{type:String,required:!0},total:{type:Number,required:!0}},setup($){const f=$,V=ye(),b=_();f.product_id!==0&&(b.value=f.product_id);const w=_(f.amount),D=_(f.unit_price),N=_();f.unit_stock!==0&&(N.value=f.unit_stock);const P=_(f.total),G=_([x=>x?!0:"El campo es requerido"]),O=_([x=>/^\d+(\.\d{1,2})?$/.test(x)?!0:"Debe ser un valor decimal"]);fe(b,(x,p)=>{const y=f.products.find(F=>F.id===x);V.setOrderItem_product_id(f.index,y.id),y&&(D.value=Number(y.price),N.value=Number(y.stock),w.value=N.value,V.setOrderItem_unit_stock(f.index,N.value),V.setOrderItem_unit_price(f.index,D.value),V.setOrderItem_unit_name(f.index,y.name),P.value=Number(w.value*D.value),V.setOrderItem_amount(f.index,Number(w.value)),V.setOrderItem_total(f.index,P.value))}),fe([w,D],([x,p],[y,F])=>{N.value!==0&&x>N.value&&(w.value=N.value),P.value=Number(x*p),V.setOrderItem_amount(f.index,Number(x)),V.setOrderItem_unit_price(f.index,Number(p)),V.setOrderItem_total(f.index,P.value)});const q=()=>{V.removeItem(Number(f.index))};return(x,p)=>{const y=i("v-col"),F=i("v-list-item"),Z=i("v-list-item-title"),L=i("v-autocomplete"),M=i("v-text-field"),H=i("v-icon"),K=i("v-btn"),X=i("v-row"),a=i("v-container");return I(),Q("div",Ae,[l(a,null,{default:o(()=>[l(X,{class:"justify-center align-center"},{default:o(()=>[l(y,{cols:"12",sm:"1"},{default:o(()=>[n(" # "+k($.index+1),1)]),_:1}),l(y,{cols:"12",sm:"4"},{default:o(()=>[l(L,{label:"Producto (*)","item-title":"name","item-value":"id",density:"compact",color:"primary",variant:"outlined","hide-details":"",items:$.products,modelValue:b.value,"onUpdate:modelValue":p[0]||(p[0]=r=>b.value=r),rules:G.value},{item:o(({props:r,item:S})=>[l(F,U(r,{title:S.raw.name}),null,16,["title"])]),"no-data":o(()=>[l(F,null,{default:o(()=>[l(Z,null,{default:o(()=>p[4]||(p[4]=[n(" No hay filtros disponibles ")])),_:1})]),_:1})]),_:1},8,["items","modelValue","rules"])]),_:1}),l(y,{cols:"12",sm:"2"},{default:o(()=>[l(M,{label:"Precio por unidad",color:"primary",variant:"outlined",maxlength:"10",modelValue:D.value,"onUpdate:modelValue":p[1]||(p[1]=r=>D.value=r),counter:"","hide-details":"",rules:O.value,density:"compact",type:"number"},null,8,["modelValue","rules"])]),_:1}),l(y,{cols:"12",sm:"2"},{default:o(()=>[l(M,{label:"Cantidad",color:"primary",variant:"outlined",maxlength:"10",modelValue:w.value,"onUpdate:modelValue":p[2]||(p[2]=r=>w.value=r),counter:"","hide-details":"",rules:O.value,density:"compact",type:"number"},null,8,["modelValue","rules"])]),_:1}),l(y,{cols:"12",sm:"2"},{default:o(()=>[l(M,{label:"Total",color:"primary",variant:"outlined",maxlength:"10",modelValue:P.value,"onUpdate:modelValue":p[3]||(p[3]=r=>P.value=r),counter:"","hide-details":"",rules:O.value,disabled:"",density:"compact",type:"number"},null,8,["modelValue","rules"])]),_:1}),l(y,{cols:"12",sm:"1",class:"text-center"},{default:o(()=>[l(K,{color:"error",onClick:q,"hide-details":"",density:"compact"},{default:o(()=>[l(H,null,{default:o(()=>p[5]||(p[5]=[n("mdi-delete")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])}}},Re=["href"],Te={class:"flex gap-4"},$e={class:"flex gap-4"},ze={class:"flex gap-4"},Be={class:"flex-2"},Ge={class:"flex-1"},Le={class:"flex gap-4"},Me={class:"flex gap-4 w-100 justify-between align-center mb-6"},Ke={class:"grid grid-cols-1 divide-y"},Xe={class:"flex gap-4"},Je={class:"flex gap-4"},Qe={class:"flex gap-4"},Ze={class:"flex-2"},He={class:"flex-1"},We={class:"flex gap-4"},Ye={class:"flex gap-4 w-100 justify-between align-center mb-6"},et={class:"grid grid-cols-1 divide-y"},tt={class:"py-6 h-full"},lt={class:"max-w-8xl mx-auto sm:px-4 lg:px-6"},ot={class:"overflow-hidden sm:rounded-sm lg:rounded-lg grid place-items-center"},at={class:"bg-gris-300 w-full grid place-items-center"},rt={class:"max-w-screen-2xl w-full px-4 py-4 sm:px-6 sm:py-4 lg:px-12 lg:py-12 bg-white-200 rounded-lg"},dt={class:"mt-4"},ut=["colspan"],nt={class:"truncated-cell"},st={__name:"Index",props:{products:{type:Array,required:!0}},setup($){const f=$,V=_(1),b=ye(),w=_([]),D=_(!1),N=_(0),P=_(""),G=_(""),O=_(10),q=_(!1),x=_(!1),p=async({page:m,itemsPerPage:e,sortBy:v})=>{D.value=!0;try{const u=await axios.get(route("orders.load",{page:m,itemsPerPage:e,sortBy:v,sortDesc:"asc",search:P.value}));V.value=u.data.orders.current_page,w.value=u.data.orders.data,N.value=u.data.orders.total}catch(u){console.error(u)}finally{D.value=!1}},y=qe(()=>x.value?w.value:w.value.filter(m=>m.order_status!=="Cancelado")),F=()=>{x.value=!x.value},Z=()=>{const m=y.value.map(u=>({ID:u.id,Fecha:L(u.created_at),Total:u.order_total,Estado:u.order_status})),e=me.json_to_sheet(m),v=me.book_new();me.book_append_sheet(v,e,"Pedidos"),Fe(v,"pedidos.xlsx")},L=m=>new Date(m).toLocaleDateString("es-PE",{year:"numeric",month:"long",day:"numeric"}),H=je(()=>{G.value=P.value},250),K=_([]),X=_([]);Ee(async()=>{K.value=[{title:"# Pedido",key:"index",align:"center"},{title:"Código",key:"order_code",align:"center"},{title:"Cliente",key:"customer_name"},{title:"Fecha",key:"created_at",align:"center"},{title:"Total",key:"order_total",align:"center"},{title:"Estado",key:"order_status",align:"center"},{title:"Acciones",key:"actions",align:"center"}],X.value=[{title:"# Item",key:"index",sortable:!1,align:"center"},{title:"Producto",key:"get_product.name",sortable:!0},{title:"Cantidad",key:"amount",sortable:!1,align:"center"},{title:"Precio Unitario",key:"unit_price",sortable:!1,align:"center"},{title:"Total",key:"total_price",sortable:!1,align:"center"}],await p({page:1,itemsPerPage:O.value})});const a=_({id:"",customer_name:"",customer_email:"",customer_phone:"",customer_address:"",customer_document_number:"",customer_document_type:1,order_status:"",order_status_update:"Cancelado",order_code:"",order_total:0,observation:"",delivery_date:"",active:!0}),r=Ie,S=_(!1),z=_(!1),B=_(!1),W=_(null),ce=_(null),Y=_(null),xe=async()=>{const{valid:m}=await W.value.validate();if(m)try{if(b.order.items.length===0){j(!0,"Debe agregar al menos un producto al pedido","#F9D7DA",3e3);return}if(a.value.order_status==="Completado"&&a.value.delivery_date===""){j(!0,"Debe ingresar la fecha de entrega","#F9D7DA",3e3);return}q.value=!0,a.value.order_status!=="Completado"&&delete a.value.delivery_date,a.value.observation===""&&delete a.value.observation;const e=b.order.items.filter(E=>E.product_id!==0),v=e.reduce((E,A)=>E+A.total,0);a.value.order_total=v;const u={...a.value,items:e},g=await axios.post(route("orders.store"),u,{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}});g.status===201&&(j(!0,g.data.message,"#D4E7C5",2e3),S.value=!1,b.clearOrderItems(),await W.value.reset(),await p({page:1,itemsPerPage:O.value}))}catch(e){te(e,e.response.data.message)}finally{q.value=!1}},Ve=async()=>{try{if(b.order.items.length===0){j(!0,"Debe agregar al menos un producto al pedido","#F9D7DA",3e3);return}if(a.value.order_status==="Completado"&&a.value.delivery_date===""){j(!0,"Debe ingresar la fecha de entrega","#F9D7DA",3e3);return}q.value=!0,a.value.order_status!=="Completado"&&delete a.value.delivery_date;const m=b.order.items.filter(g=>g.product_id!==0),e=m.reduce((g,E)=>g+E.total,0);a.value.order_total=e;const v={...a.value,items:m},u=await axios.patch(route("orders.updateOrder",{code:a.value.order_code}),v,{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}});u.status===200&&(j(!0,u.data.message,"#D4E7C5",2e3),z.value=!1,b.clearOrderItems(),ce.value.reset(),await p({page:V.value,itemsPerPage:O.value}))}catch(m){te(m,m.response.data.message)}finally{q.value=!1}},Ce=async()=>{const{valid:m}=await Y.value.validate();if(m)try{q.value=!0;const e=await axios.patch(route("orders.updateStatus",{code:a.value.order_code}),{order_status:a.value.order_status_update},{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}});e.status===200&&(j(!0,e.data.message,"#D4E7C5",2e3),B.value=!1,Y.value.reset(),await p({page:V.value,itemsPerPage:O.value}))}catch(e){te(e,e.response.data.message)}finally{q.value=!1}},ee=(m,e)=>{if(b.clearOrderItems(),m==="create_order")a.value={id:0,customer_name:"",customer_email:"",customer_phone:"",customer_address:"",customer_document_number:"",customer_document_type:1,order_status:"Pendiente de Pago",order_total:0,observation:"",delivery_date:"",active:!0,items:[]},S.value=!0;else if(m==="update_order"){z.value=!0,a.value=e,a.value.customer_document_type=Number(e.customer_document_type);const v=e.get_products.map(u=>({id:u.id,uuid:crypto.randomUUID(),product_id:u.product_id,amount:u.amount,unit_price:Number(u.unit_price),unit_stock:Number(u.get_product.stock)+Number(u.amount),unit_name:u.get_product.name,total:Number(u.total_price)}));b.addItems(v)}else m==="delete_order"&&(B.value=!0,a.value.id=e.id,a.value.customer_name=e.customer_name,a.value.order_code=e.order_code,a.value.order_status_update="Cancelado")},C=_({status:!1,message:"",color:"#D4E7C5",timeout:1e3,vertical:!0,location:"right top",rounded:"md"}),j=(m,e,v,u)=>{C.value.status=m,C.value.message=e,C.value.color=v,C.value.timeout=u},te=(m,e)=>{console.error(m),j(!0,e,"#F9D7DA",3e3)};return(m,e)=>{const v=i("v-text-field"),u=i("v-chip"),g=i("v-list-item"),E=i("v-list-item-title"),A=i("v-autocomplete"),ve=i("v-textarea"),_e=i("v-checkbox"),R=i("v-icon"),h=i("v-btn"),le=i("v-card-text"),oe=i("v-divider"),ae=i("v-card-actions"),re=i("v-form"),J=i("v-card"),de=i("v-dialog"),ue=i("v-col"),pe=i("v-row"),ke=i("v-progress-linear"),we=i("v-data-table"),Pe=i("v-data-table-server");return I(),Q(ie,null,[l(d(he),{title:"Pedidos"},{default:o(()=>[s("link",{rel:"icon",href:d(De),type:"image/png",sizes:"16x16"},null,8,Re),e[31]||(e[31]=s("meta",{name:"viewport",content:"width=device-width, initial-scale=1"},null,-1))]),_:1}),l(Ne,{modelValue:C.value.status,"onUpdate:modelValue":e[0]||(e[0]=t=>C.value.status=t),message:C.value.message,color:C.value.color,timeout:C.value.timeout,vertical:C.value.vertical,location:C.value.location,rounded:C.value.rounded,style:{margin:"6.5rem 2rem 0 0"}},{default:o(()=>[n(k(C.value.message),1)]),_:1},8,["modelValue","message","color","timeout","vertical","location","rounded"]),l(de,{modelValue:S.value,"onUpdate:modelValue":e[12]||(e[12]=t=>S.value=t),width:"1000",persistent:""},{default:o(()=>[l(J,{"max-width":"1000",title:"Guardar Pedido","prepend-icon":"mdi-shopping"},{default:o(()=>[l(re,{onSubmit:se(xe,["prevent"]),ref_key:"form_create_order",ref:W,"fast-fail":""},{default:o(()=>[l(le,{class:"px-8 py-8"},{default:o(()=>[s("div",Te,[l(v,{density:"comfortable",modelValue:a.value.customer_name,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.customer_name=t),label:"Nombre del Cliente (*)",color:"#0e7490",variant:"outlined",required:"",hint:"Ejemplo: Jhon Doe",rules:[d(r).required]},null,8,["modelValue","rules"]),l(v,{density:"comfortable",modelValue:a.value.customer_email,"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.customer_email=t),label:"Correo Electrónico (*)",color:"#0e7490",variant:"outlined",required:"",hint:"Ejemplo: jhondoe@gmail.com",rules:[d(r).required,d(r).email]},null,8,["modelValue","rules"])]),s("div",$e,[l(v,{density:"comfortable",modelValue:a.value.customer_phone,"onUpdate:modelValue":e[3]||(e[3]=t=>a.value.customer_phone=t),label:"Teléfono (*)",color:"#0e7490",variant:"outlined",required:"",hint:"Ejemplo: 1234567890",rules:[d(r).required,d(r).phone]},null,8,["modelValue","rules"]),l(v,{density:"comfortable",modelValue:a.value.customer_address,"onUpdate:modelValue":e[4]||(e[4]=t=>a.value.customer_address=t),label:"Dirección (*)",color:"#0e7490",variant:"outlined",required:"",hint:"Ejemplo: Calle 123",rules:[d(r).required,d(r).address]},null,8,["modelValue","rules"])]),s("div",ze,[s("div",Be,[l(A,{dense:"",modelValue:a.value.customer_document_type,"onUpdate:modelValue":e[5]||(e[5]=t=>a.value.customer_document_type=t),label:"Tipo de Documento (*)","item-title":"name","item-value":"value",chips:"",density:"comfortable",color:"#0e7490",variant:"outlined",required:"",rules:[d(r).required],items:[{name:"DNI",value:1},{name:"RUC",value:2}]},{chip:o(({props:t,item:c})=>[l(u,U(t,{text:c.raw.name,color:"#0e7490"}),null,16,["text"])]),item:o(({props:t,item:c})=>[l(g,U(t,{title:c.raw.name}),null,16,["title"])]),"no-data":o(()=>[l(g,null,{default:o(()=>[l(E,null,{default:o(()=>e[32]||(e[32]=[n(" No hay filtros disponibles ")])),_:1})]),_:1})]),_:1},8,["modelValue","rules"])]),s("div",Ge,[l(v,{density:"comfortable",modelValue:a.value.customer_document_number,"onUpdate:modelValue":e[6]||(e[6]=t=>a.value.customer_document_number=t),label:a.value.customer_document_type===1?"Dni (*)":"Ruc (*)",type:"text",rules:a.value.customer_document_type===1?[d(r).required,d(r).dni]:[d(r).required,d(r).ruc],color:"#0e7490",variant:"outlined",required:"",hint:"Ejemplo: 00099900",maxlength:a.value.customer_document_type===1?8:11},null,8,["modelValue","label","rules","maxlength"])])]),s("div",Le,[l(A,{dense:"",modelValue:a.value.order_status,"onUpdate:modelValue":e[7]||(e[7]=t=>a.value.order_status=t),label:"Estado del Pedido (*)","item-title":"name","item-value":"value",chips:"",density:"comfortable",color:"#0e7490",variant:"outlined",required:"",rules:[d(r).required],items:[{name:"Pendiente de Pago",value:"Pendiente de Pago"},{name:"Pendiente de Entrega",value:"Pendiente de Entrega"},{name:"Completado",value:"Completado"}]},{chip:o(({props:t,item:c})=>[l(u,U(t,{text:c.raw.name,color:"#0e7490"}),null,16,["text"])]),item:o(({props:t,item:c})=>[l(g,U(t,{title:c.raw.name}),null,16,["title"])]),"no-data":o(()=>[l(g,null,{default:o(()=>[l(E,null,{default:o(()=>e[33]||(e[33]=[n(" No hay filtros disponibles ")])),_:1})]),_:1})]),_:1},8,["modelValue","rules"]),l(v,{density:"comfortable",modelValue:a.value.delivery_date,"onUpdate:modelValue":e[8]||(e[8]=t=>a.value.delivery_date=t),label:a.value.order_status==="Completado"?"Fecha de Entrega (*)":"Fecha de Entrega",type:"date",disabled:a.value.order_status!=="Completado",rules:a.value.order_status==="Completado"?[d(r).required]:[],"model-value":a.value.order_status==="Completado"?a.value.delivery_date:"",color:"#0e7490",variant:"outlined",required:"",hint:"Ejemplo: 2021-10-10"},null,8,["modelValue","label","disabled","rules","model-value"])]),l(ve,{modelValue:a.value.observation,"onUpdate:modelValue":e[9]||(e[9]=t=>a.value.observation=t),label:"Observación",color:"#0e7490",variant:"outlined",hint:"Ejemplo: Falta el pago de manera presencial",rows:"3",clearable:"",density:"comfortable",counter:"",maxlength:"255","no-resize":""},null,8,["modelValue"]),l(_e,{label:"Activo",modelValue:a.value.active,"onUpdate:modelValue":e[10]||(e[10]=t=>a.value.active=t),color:"#0e7490",rules:[d(r).boolean]},null,8,["modelValue","rules"]),s("div",Me,[e[35]||(e[35]=s("h2",{class:"text-xl font-weight-medium tracking-normal"}," Productos ",-1)),l(h,{color:"#0e7490",density:"comfortable",onClick:d(b).addItem},{default:o(()=>[l(R,{left:""},{default:o(()=>e[34]||(e[34]=[n("mdi-plus")])),_:1})]),_:1},8,["onClick"])]),s("div",Ke,[(I(!0),Q(ie,null,be(d(b).getOrder_items,(t,c)=>(I(),T(ge,{products:f.products,product_id:t.product_id,key:t.uuid,index:c,amount:t.amount,unit_price:t.unit_price,unit_stock:t.unit_stock,unit_name:t.unit_name,total:t.total},null,8,["products","product_id","index","amount","unit_price","unit_stock","unit_name","total"]))),128))]),e[36]||(e[36]=s("small",{class:"text-caption text-medium-emphasis mt-6 block"}," (*) Campos requeridos ",-1))]),_:1}),l(ae,null,{default:o(()=>[l(oe),l(h,{onClick:e[11]||(e[11]=t=>S.value=!1)},{default:o(()=>e[37]||(e[37]=[n(" Cancelar ")])),_:1}),l(h,{type:"submit",color:"#0e7490",loading:q.value},{default:o(()=>e[38]||(e[38]=[n(" Guardar ")])),_:1},8,["loading"])]),_:1})]),_:1},512)]),_:1})]),_:1},8,["modelValue"]),l(de,{modelValue:z.value,"onUpdate:modelValue":e[24]||(e[24]=t=>z.value=t),width:"1000",persistent:""},{default:o(()=>[l(J,{"max-width":"1000",title:"Actualizar Pedido: "+a.value.order_code,"prepend-icon":"mdi-shopping"},{default:o(()=>[l(re,{onSubmit:se(Ve,["prevent"]),ref_key:"form_update_order",ref:ce,"fast-fail":""},{default:o(()=>[l(le,{class:"px-8 py-8"},{default:o(()=>[s("div",Xe,[l(v,{density:"comfortable",modelValue:a.value.customer_name,"onUpdate:modelValue":e[13]||(e[13]=t=>a.value.customer_name=t),label:"Nombre del Cliente (*)",color:"#0e7490",variant:"outlined",hint:"Ejemplo: Jhon Doe",rules:[d(r).required]},null,8,["modelValue","rules"]),l(v,{density:"comfortable",modelValue:a.value.customer_email,"onUpdate:modelValue":e[14]||(e[14]=t=>a.value.customer_email=t),label:"Correo Electrónico (*)",color:"#0e7490",variant:"outlined",hint:"Ejemplo: jhondoe@gmail.com",rules:[d(r).required,d(r).email]},null,8,["modelValue","rules"])]),s("div",Je,[l(v,{density:"comfortable",modelValue:a.value.customer_phone,"onUpdate:modelValue":e[15]||(e[15]=t=>a.value.customer_phone=t),label:"Teléfono (*)",color:"#0e7490",variant:"outlined",hint:"Ejemplo: 1234567890",rules:[d(r).required,d(r).phone]},null,8,["modelValue","rules"]),l(v,{density:"comfortable",modelValue:a.value.customer_address,"onUpdate:modelValue":e[16]||(e[16]=t=>a.value.customer_address=t),label:"Dirección (*)",color:"#0e7490",variant:"outlined",hint:"Ejemplo: Calle 123",rules:[d(r).required,d(r).address]},null,8,["modelValue","rules"])]),s("div",Qe,[s("div",Ze,[l(A,{dense:"",modelValue:a.value.customer_document_type,"onUpdate:modelValue":e[17]||(e[17]=t=>a.value.customer_document_type=t),label:"Tipo de Documento (*)","item-title":"name","item-value":"value",chips:"",density:"comfortable",color:"#0e7490",variant:"outlined",rules:[d(r).required],items:[{name:"DNI",value:1},{name:"RUC",value:2}]},{chip:o(({props:t,item:c})=>[l(u,U(t,{text:c.raw.name,color:"#0e7490"}),null,16,["text"])]),item:o(({props:t,item:c})=>[l(g,U(t,{title:c.raw.name}),null,16,["title"])]),"no-data":o(()=>[l(g,null,{default:o(()=>[l(E,null,{default:o(()=>e[39]||(e[39]=[n(" No hay filtros disponibles ")])),_:1})]),_:1})]),_:1},8,["modelValue","rules"])]),s("div",He,[l(v,{density:"comfortable",modelValue:a.value.customer_document_number,"onUpdate:modelValue":e[18]||(e[18]=t=>a.value.customer_document_number=t),label:a.value.customer_document_type===1?"Dni (*)":"Ruc (*)",type:"text",rules:a.value.customer_document_type===1?[d(r).required,d(r).dni]:[d(r).required,d(r).ruc],color:"#0e7490",variant:"outlined",required:"",hint:"Ejemplo: 00099900",maxlength:a.value.customer_document_type===1?8:11},null,8,["modelValue","label","rules","maxlength"])])]),s("div",We,[l(A,{dense:"",modelValue:a.value.order_status,"onUpdate:modelValue":e[19]||(e[19]=t=>a.value.order_status=t),label:"Estado del Pedido (*)","item-title":"name","item-value":"value",chips:"",density:"comfortable",color:"#0e7490",variant:"outlined",rules:[d(r).required],items:[{name:"Pendiente de Pago",value:"Pendiente de Pago"},{name:"Pendiente de Entrega",value:"Pendiente de Entrega"},{name:"Completado",value:"Completado"}]},{chip:o(({props:t,item:c})=>[l(u,U(t,{text:c.raw.name,color:"#0e7490"}),null,16,["text"])]),item:o(({props:t,item:c})=>[l(g,U(t,{title:c.raw.name}),null,16,["title"])]),"no-data":o(()=>[l(g,null,{default:o(()=>[l(E,null,{default:o(()=>e[40]||(e[40]=[n(" No hay filtros disponibles ")])),_:1})]),_:1})]),_:1},8,["modelValue","rules"]),l(v,{density:"comfortable",modelValue:a.value.delivery_date,"onUpdate:modelValue":e[20]||(e[20]=t=>a.value.delivery_date=t),label:a.value.order_status==="Completado"?"Fecha de Entrega (*)":"Fecha de Entrega",type:"date",disabled:a.value.order_status!=="Completado",rules:a.value.order_status==="Completado"?[d(r).required]:[],"model-value":a.value.order_status==="Completado"?a.value.delivery_date:"",color:"#0e7490",variant:"outlined",required:"",hint:"Ejemplo: 2021-10-10"},null,8,["modelValue","label","disabled","rules","model-value"])]),l(ve,{modelValue:a.value.observation,"onUpdate:modelValue":e[21]||(e[21]=t=>a.value.observation=t),label:"Observación",color:"#0e7490",variant:"outlined",hint:"Ejemplo: Falta el pago de manera presencial",rows:"3",clearable:"",density:"comfortable",counter:"",maxlength:"255","no-resize":""},null,8,["modelValue"]),l(_e,{label:"Activo",modelValue:a.value.active,"onUpdate:modelValue":e[22]||(e[22]=t=>a.value.active=t),color:"#0e7490",rules:[d(r).boolean]},null,8,["modelValue","rules"]),s("div",Ye,[e[42]||(e[42]=s("h2",{class:"text-xl font-weight-medium tracking-normal"}," Productos ",-1)),l(h,{color:"#0e7490",density:"comfortable",onClick:d(b).addItem},{default:o(()=>[l(R,{left:""},{default:o(()=>e[41]||(e[41]=[n("mdi-plus")])),_:1})]),_:1},8,["onClick"])]),s("div",et,[(I(!0),Q(ie,null,be(d(b).getOrder_items,(t,c)=>(I(),T(ge,{products:f.products,product_id:t.product_id,key:t.uuid,index:c,amount:t.amount,unit_price:t.unit_price,unit_stock:t.unit_stock,unit_name:t.unit_name,total:t.total},null,8,["products","product_id","index","amount","unit_price","unit_stock","unit_name","total"]))),128))]),e[43]||(e[43]=s("small",{class:"text-caption text-medium-emphasis mt-6 block"}," (*) Campos requeridos ",-1))]),_:1}),l(ae,null,{default:o(()=>[l(oe),l(h,{onClick:e[23]||(e[23]=t=>z.value=!1)},{default:o(()=>e[44]||(e[44]=[n(" Cancelar ")])),_:1}),l(h,{color:"#0e7490",loading:q.value,type:"submit"},{default:o(()=>e[45]||(e[45]=[n(" Actualizar ")])),_:1},8,["loading"])]),_:1})]),_:1},512)]),_:1},8,["title"])]),_:1},8,["modelValue"]),l(de,{modelValue:B.value,"onUpdate:modelValue":e[27]||(e[27]=t=>B.value=t),width:"500",persistent:""},{default:o(()=>[l(J,{"max-width":"500",title:"Pedido: "+a.value.order_code,"prepend-icon":"mdi-delete"},{default:o(()=>[l(re,{onSubmit:se(Ce,["prevent"]),ref_key:"form_delete_order",ref:Y,"fast-fail":""},{default:o(()=>[l(le,{class:"px-8 py-8"},{default:o(()=>[l(pe,null,{default:o(()=>[l(ue,{cols:"12"},{default:o(()=>[l(A,{dense:"",modelValue:a.value.order_status_update,"onUpdate:modelValue":e[25]||(e[25]=t=>a.value.order_status_update=t),label:"Acciones (*)","item-title":"name","item-value":"value",chips:"",density:"comfortable",color:"#0e7490",variant:"outlined",required:"",rules:[d(r).required],items:[{name:"Cancelar",value:"Cancelado"},{name:"Reembolzar",value:"Reembolsado"}]},{chip:o(({props:t,item:c})=>[l(u,U(t,{text:c.raw.name,color:"#0e7490"}),null,16,["text"])]),item:o(({props:t,item:c})=>[l(g,U(t,{title:c.raw.name}),null,16,["title"])]),"no-data":o(()=>[l(g,null,{default:o(()=>[l(E,null,{default:o(()=>e[46]||(e[46]=[n(" No hay filtros disponibles ")])),_:1})]),_:1})]),_:1},8,["modelValue","rules"])]),_:1})]),_:1})]),_:1}),l(ae,null,{default:o(()=>[l(oe),l(h,{onClick:e[26]||(e[26]=t=>B.value=!1)},{default:o(()=>e[47]||(e[47]=[n(" Cancelar ")])),_:1}),l(h,{color:"#0e7490",loading:q.value,type:"submit"},{default:o(()=>e[48]||(e[48]=[n(" Guardar ")])),_:1},8,["loading"])]),_:1})]),_:1},512)]),_:1},8,["title"])]),_:1},8,["modelValue"]),l(Ue,null,{default:o(()=>[s("div",tt,[s("div",lt,[s("div",ot,[s("section",at,[s("div",rt,[l(Oe,{title:"Gestiona tus Pedidos",breadcrumb:"Pedidos",breadcrumb_link:m.route("orders.index")},null,8,["breadcrumb_link"]),s("article",dt,[l(J,{variant:"flat"},{title:o(()=>[l(pe,{align:"center",justify:"space-between",density:"comfortable",class:"p-2"},{default:o(()=>[l(ue,{cols:"12",md:"6"},{default:o(()=>e[49]||(e[49]=[s("h2",{class:"text-lg md:text-xl lg:text-xl text-gray-900"},"Pedidos",-1)])),_:1}),l(ue,{cols:"12",md:"6",class:"text-right flex justify-end items-center"},{default:o(()=>[l(h,{color:"#0e7490",onClick:e[28]||(e[28]=t=>ee("create_order"))},{default:o(()=>[l(R,{left:""},{default:o(()=>e[50]||(e[50]=[n("mdi-plus")])),_:1}),e[51]||(e[51]=n(" Agregar Pedido "))]),_:1}),l(h,{color:"secondary",onClick:F,class:"ml-2"},{default:o(()=>[l(R,{left:""},{default:o(()=>e[52]||(e[52]=[n("mdi-eye-off")])),_:1}),n(" "+k(x.value?"Mostrar Cancelados":"Ocultar Cancelados"),1)]),_:1}),l(h,{color:"success",onClick:Z,class:"ml-2"},{default:o(()=>[l(R,{left:""},{default:o(()=>e[53]||(e[53]=[n("mdi-microsoft-excel")])),_:1}),e[54]||(e[54]=n(" Exportar a Excel "))]),_:1})]),_:1})]),_:1})]),text:o(()=>[l(v,{modelValue:P.value,"onUpdate:modelValue":e[29]||(e[29]=t=>P.value=t),label:"Buscar Pedido","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"","single-line":"",density:"comfortable",color:"#0e7490",onInput:d(H)},null,8,["modelValue","onInput"]),l(Pe,{"items-per-page":O.value,"onUpdate:itemsPerPage":e[30]||(e[30]=t=>O.value=t),headers:K.value,items:y.value,"items-length":N.value,loading:D.value,search:G.value,"item-value":"id","onUpdate:options":p,"loading-text":"Cargando Pedidos","no-data-text":"Actualmente no hay pedidos disponibles","items-per-page-text":"Pedidos por página","show-expand":""},{loader:o(({isActive:t})=>[l(ke,{active:t,color:"#0e7490",height:"3",indeterminate:""},null,8,["active"])]),"item.index":o(({index:t})=>[n(k(t+1),1)]),"item.created_at":o(({item:t})=>[n(k(L(t.created_at)),1)]),"item.total":o(({item:t})=>[l(u,{color:"green",label:""},{default:o(()=>[n(k(t.total),1)]),_:2},1024)]),"item.order_status":o(({item:t})=>[t.order_status==="Completado"?(I(),T(u,{key:0,color:"green",label:""},{default:o(()=>[n(k(t.order_status),1)]),_:2},1024)):t.order_status==="Cancelado"?(I(),T(u,{key:1,color:"red",label:""},{default:o(()=>[n(k(t.order_status),1)]),_:2},1024)):t.order_status==="Reembolsado"?(I(),T(u,{key:2,color:"black",label:""},{default:o(()=>[n(k(t.order_status),1)]),_:2},1024)):(I(),T(u,{key:3,color:"#0e7490",label:""},{default:o(()=>[n(k(t.order_status),1)]),_:2},1024))]),"item.actions":o(({item:t})=>[l(R,{class:"cursor-pointer",color:"#0e7490",style:{"margin-right":".5rem"},onClick:c=>ee("update_order",t),disabled:t.order_status==="Completado"||t.order_status==="Cancelado"||t.order_status==="Reembolsado"},{default:o(()=>e[55]||(e[55]=[n(" mdi-pencil ")])),_:2},1032,["onClick","disabled"]),l(R,{class:"cursor-pointer",color:"#0e7490",style:{"margin-left":".5rem"},onClick:c=>ee("delete_order",t),disabled:t.order_status==="Completado"||t.order_status==="Cancelado"||t.order_status==="Reembolsado"},{default:o(()=>e[56]||(e[56]=[n(" mdi-delete ")])),_:2},1032,["onClick","disabled"])]),"expanded-row":o(({columns:t,item:c})=>[s("tr",null,[s("td",{colspan:t.length,style:{padding:"1rem 5rem 1rem 5rem"}},[l(we,{headers:X.value,items:c.get_products,"no-data-text":"Actualmente no hay items en el pedido","items-per-page":"5",style:{border:"2px solid #adadad","border-radius":".5rem"}},{"item.index":o(({index:ne})=>[n(k(ne+1),1)]),"item.get_product.name":o(({item:ne})=>[s("div",nt,k(ne.get_product.name),1)]),_:2},1032,["headers","items"])],8,ut)])]),_:1},8,["items-per-page","headers","items","items-length","loading","search"])]),_:1})])])])])])])]),_:1})],64)}}},Vt=Se(st,[["__scopeId","data-v-6cd233f7"]]);export{Vt as default};
